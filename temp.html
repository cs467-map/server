<p>A Node.js/Express powered server for all your mapping needs!</p>
<h1 id="quickstart">Quickstart</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="bu">source</span> .env</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="ex">npm</span> run build</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="ex">npm</span> run start</a></code></pre></div>
<h1 id="server-setup">Server Setup</h1>
<ul>
<li><p>Get Source Code: https://github.com/cs467-map/server</p></li>
<li><p>Install Node.js/npm: <a href="https://nodejs.org/en/download/">OS specific instructions.</a></p></li>
<li><p>Start Server</p></li>
</ul>
<p>To build and run the server, enter</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># install dependencies</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="ex">npm</span> install</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># set environment varibales</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="bu">source</span> .env</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># build bundle</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="ex">npm</span> run build</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co"># start server</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="ex">npm</span> run start</a></code></pre></div>
<p>The server’s npm commands are defined in the package.json file:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb3-1" title="1">  <span class="er">&quot;scripts&quot;:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="dt">&quot;start&quot;</span><span class="fu">:</span> <span class="st">&quot;nodemon -e js,ejs,json,css,md index.js&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="dt">&quot;test&quot;</span><span class="fu">:</span> <span class="st">&quot;node test.js&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="dt">&quot;build&quot;</span><span class="fu">:</span> <span class="st">&quot;webpack --config webpack.config.js --mode production&quot;</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="dt">&quot;watch&quot;</span><span class="fu">:</span> <span class="st">&quot;webpack --config webpack.config.js --mode production --watch&quot;</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="fu">}</span><span class="er">,</span></a></code></pre></div>
<p>Browse to localhost:5000 and you should see the map!</p>
<figure>
<img src="./example.png" alt="example of server running on localhost" /><figcaption>example of server running on localhost</figcaption>
</figure>
<h1 id="heroku-setup">Heroku Setup</h1>
<p>Helpful article:</p>
<p>https://devcenter.heroku.com/articles/getting-started-with-nodejs?singlepage=true</p>
<h2 id="install-heroku">Install Heroku</h2>
<ul>
<li><a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs?singlepage=true#set-up">OS-specific instructions</a></li>
</ul>
<p>See the section <em>Note on Passwords</em> below for a note on security.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># login to Heroku</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">heroku</span> login</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># if not already in the server directory, cd to it.</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="bu">cd</span> server</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># set environmental variables.</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="bu">source</span> .env</a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co"># set database url for heroku host to use</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="ex">heroku</span> config:set DATABASE_URL=postgres://USER:PASSWORD@HOST/DATABASE</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co"># add heroku remote </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="ex">heroku</span> git:remote -a <span class="va">$APP</span></a>
<a class="sourceLine" id="cb4-15" title="15"></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co"># push to the heroku host</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="fu">git</span> push heroku master</a></code></pre></div>
<h1 id="database-setup">Database Setup</h1>
<p>Database installation and configuration instructions may be found <a href="https://github.com/cs467-map/database">here</a>.</p>
<h1 id="note-on-passwords">Note on Passwords</h1>
<p>One of the commands above requires the password to interface with the hosted database.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="ex">heroku</span> config:set DATABASE_URL=postgres://USER:PASSWORD@HOST/DATABASE</a></code></pre></div>
<p>There are a few options available for inputting the password, each with different security levels and setup requirements:</p>
<h3 id="plain-input">Plain Input</h3>
<p>Not very secure, as the password can be viewed as plain text and possibly stored in command history. But, it is fast and handy.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="ex">heroku</span> config:set DATABASE_URL=postgres://coolUser:password123!@coolHost/coolDb</a></code></pre></div>
<h3 id="export-environmental-variable">Export Environmental Variable</h3>
<p>A little bit more secure, but the environmental variable may still may be viewed in command history, or by the operating system’s superuser. <a href="https://borgbackup.readthedocs.io/en/stable/quickstart.html#pitfalls-with-shell-variables-and-environment-variables">See also.</a></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="bu">export</span> <span class="va">DB_PASS</span> <span class="va">=</span> <span class="st">&#39;password123!&#39;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="ex">heroku</span> config:set DATABASE_URL=postgres://coolUser:DB_PASS@coolHost/coolDb</a></code></pre></div>
<h3 id="use-a-password-manager">Use a Password Manager</h3>
<p>Much more secure, but requires some setup. <a href="https://www.passwordstore.org/">Pass</a> and <a href="https://keepassxc.org/">KeepassXC</a> are two Free, Open Source, and Cross Platform options.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" title="1"><span class="ex">pass</span> init</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="ex">pass</span> add db</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="ex">heroku</span> config:set DATABASE_URL=postgres://coolUser:<span class="va">$(</span><span class="ex">pass</span> show db<span class="va">)</span>@coolHost/coolDb</a></code></pre></div>
